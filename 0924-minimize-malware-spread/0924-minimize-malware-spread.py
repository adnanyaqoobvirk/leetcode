class Solution:
    def minMalwareSpread(self, graph: List[List[int]], initial: List[int]) -> int:
        iset = set(initial)
        miset = iset.copy()
        max_cnt = 0
        ans = -1
        while iset:
            start = iset.pop()
            q = [start]
            seen = set()
            seen.add(start)
            cnt = 1
            while q:
                nq = []
                for node in q:
                    if node != start and node in miset:
                        cnt = 0
                        break
                    for nei, connected in enumerate(graph[node]):
                        if nei != node and connected == 1 and nei not in seen:
                            seen.add(nei)
                            nq.append(nei)
                else:
                    cnt += len(nq)
                    q = nq
                    continue
                break
            if ans == -1 or cnt > max_cnt or (cnt == max_cnt and start < ans):
                max_cnt = cnt
                ans = start
        return ans 