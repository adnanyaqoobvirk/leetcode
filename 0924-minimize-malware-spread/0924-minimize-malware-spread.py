class Solution:
    def minMalwareSpread(self, graph: List[List[int]], initial: List[int]) -> int:
        miset = set(initial)
        max_cnt = ans = -1
        for start in miset:
            q = [start]
            seen = {start}
            cnt = 1
            while q:
                nq = []
                for node in q:
                    if node != start and node in miset:
                        cnt = 0
                        break
                    for nei, connected in enumerate(graph[node]):
                        if connected and nei not in seen:
                            seen.add(nei)
                            nq.append(nei)
                else:
                    cnt += len(nq)
                    q = nq
                    continue
                break
            if cnt > max_cnt or (cnt == max_cnt and start < ans):
                max_cnt = cnt
                ans = start
        return ans 